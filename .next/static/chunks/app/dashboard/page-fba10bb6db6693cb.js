(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{108:(e,a,i)=>{Promise.resolve().then(i.bind(i,2946))},2946:(e,a,i)=>{"use strict";i.r(a),i.d(a,{default:()=>o});var n=i(5155),t=i(2108),l=i(5695),s=i(2115);function r(){let e=(0,l.useRouter)(),[a,i]=(0,s.useState)(!1),[t,r]=(0,s.useState)({title:"",description:"",logoFile:null,galleryFiles:[],fundingTarget:"",amountRaised:"0",investorCount:"0",equityOffered:"",preMoneyValuation:"",sharePrice:"",additionalInvestment:"",website:"",companiesHouseLink:"",linkedinLink:"",instagramLink:"",facebookLink:"",sections:[{title:"",description:""}],deadline:"",categories:[""],valueHighlights:[""]}),o=e=>{let{name:a,value:i}=e.target;r(e=>({...e,[a]:i}))},d=(e,a)=>{let i=e.target.files;i&&("galleryFiles"===a?r(e=>({...e,galleryFiles:[...e.galleryFiles,...Array.from(i)]})):r(e=>({...e,logoFile:i[0]||null})))},c=(e,a,i)=>{let n=[...t.sections];n[e][a]=i,r(e=>({...e,sections:n}))},u=()=>{r(e=>({...e,sections:[...e.sections,{title:"",description:""}]}))},p=e=>{r(a=>({...a,sections:a.sections.filter((a,i)=>i!==e)}))},m=(e,a)=>{let i=[...t.categories];i[e]=a,r(e=>({...e,categories:i}))},g=()=>{r(e=>({...e,categories:[...e.categories,""]}))},h=e=>{r(a=>({...a,categories:a.categories.filter((a,i)=>i!==e)}))},b=(e,a)=>{let i=[...t.valueHighlights];i[e]=a,r(e=>({...e,valueHighlights:i}))},x=()=>{r(e=>({...e,valueHighlights:[...e.valueHighlights,""]}))},f=e=>{r(a=>({...a,valueHighlights:a.valueHighlights.filter((a,i)=>i!==e)}))},v=async a=>{a.preventDefault(),i(!0);let n=new FormData;n.append("title",t.title),n.append("description",t.description),n.append("fundingTarget",t.fundingTarget),n.append("equityOffered",t.equityOffered),n.append("preMoneyValuation",t.preMoneyValuation),n.append("sharePrice",t.sharePrice),n.append("additionalInvestment",t.additionalInvestment),n.append("website",t.website),n.append("companiesHouseLink",t.companiesHouseLink),n.append("linkedinLink",t.linkedinLink),n.append("instagramLink",t.instagramLink),n.append("facebookLink",t.facebookLink),n.append("deadline",t.deadline),t.logoFile&&n.append("logoFile",t.logoFile),t.galleryFiles.forEach(e=>n.append("galleryFiles",e)),n.append("categories",JSON.stringify(t.categories)),n.append("sections",JSON.stringify(t.sections)),n.append("valueHighlights",JSON.stringify(t.valueHighlights));try{if(Object.entries(t).forEach(e=>{let[a,i]=e;console.log(a,i)}),!(await fetch("/api/campaigns",{method:"POST",body:n})).ok)throw Error("Failed to create campaign");alert("Campaign created successfully!"),e.push("/dashboard")}catch(e){console.error(e),alert("Error creating campaign")}finally{i(!1)}};return(0,n.jsxs)("form",{onSubmit:v,className:"max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-lg space-y-6",noValidate:!0,children:[(0,n.jsx)("h2",{className:"text-3xl font-bold mb-4 text-center",children:"Create Campaign"}),(0,n.jsx)("input",{name:"title",placeholder:"Campaign Title",value:t.title,onChange:o,className:"input input-bordered w-full",required:!0}),(0,n.jsx)("textarea",{name:"description",placeholder:"Description",value:t.description,onChange:o,className:"input input-bordered w-full min-h-[100px]",required:!0}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-semibold mb-1",children:"Logo Upload"}),(0,n.jsx)("input",{type:"file",accept:"image/*",onChange:e=>d(e,"logoFile"),className:"input input-bordered w-full",required:!0}),t.logoFile&&(0,n.jsx)("img",{src:URL.createObjectURL(t.logoFile),alt:"Logo preview",className:"h-24 mt-3 rounded-md object-contain"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsx)("input",{name:"fundingTarget",placeholder:"Funding Target",type:"number",value:t.fundingTarget,onChange:o,className:"input input-bordered",required:!0}),(0,n.jsx)("input",{name:"equityOffered",placeholder:"Equity Offered (%)",type:"number",value:t.equityOffered,onChange:o,className:"input input-bordered",required:!0}),(0,n.jsx)("input",{name:"preMoneyValuation",placeholder:"Pre-money Valuation",type:"number",value:t.preMoneyValuation,onChange:o,className:"input input-bordered",required:!0})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsx)("input",{name:"sharePrice",placeholder:"Share Price",type:"number",value:t.sharePrice,onChange:o,className:"input input-bordered",required:!0}),(0,n.jsx)("input",{name:"additionalInvestment",placeholder:"Additional Investment",type:"number",value:t.additionalInvestment,onChange:o,className:"input input-bordered"}),(0,n.jsx)("input",{name:"deadline",type:"date",value:t.deadline,onChange:o,className:"input input-bordered",required:!0})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)("input",{name:"website",placeholder:"Website URL",value:t.website,onChange:o,className:"input input-bordered"}),(0,n.jsx)("input",{name:"companiesHouseLink",placeholder:"Companies House Link",value:t.companiesHouseLink,onChange:o,className:"input input-bordered"}),(0,n.jsx)("input",{name:"linkedinLink",placeholder:"LinkedIn",value:t.linkedinLink,onChange:o,className:"input input-bordered"}),(0,n.jsx)("input",{name:"instagramLink",placeholder:"Instagram",value:t.instagramLink,onChange:o,className:"input input-bordered"}),(0,n.jsx)("input",{name:"facebookLink",placeholder:"Facebook",value:t.facebookLink,onChange:o,className:"input input-bordered"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-semibold mb-1",children:"Gallery Image Upload"}),(0,n.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>d(e,"galleryFiles"),className:"input input-bordered w-full"}),t.galleryFiles.length>0&&(0,n.jsx)("div",{className:"grid grid-cols-3 gap-3 mt-3",children:t.galleryFiles.map((e,a)=>(0,n.jsx)("img",{src:URL.createObjectURL(e),alt:"Gallery ".concat(a),className:"h-24 rounded-md object-cover"},a))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-semibold mb-1",children:"Key Highlights"}),t.valueHighlights.map((e,a)=>(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("input",{type:"text",placeholder:"Highlight",value:e,onChange:e=>b(a,e.target.value),className:"input input-bordered flex-grow"}),(0,n.jsx)("button",{type:"button",onClick:()=>f(a),className:"btn btn-error btn-sm px-3 h-8 rounded","aria-label":"Remove highlight ".concat(a+1),disabled:1===t.valueHighlights.length,children:"−"}),a===t.valueHighlights.length-1&&(0,n.jsx)("button",{type:"button",onClick:x,className:"btn btn-outline btn-sm px-3 h-8 rounded","aria-label":"Add highlight",children:"+"})]},a))]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-semibold mb-1",children:"Sections"}),t.sections.map((e,a)=>(0,n.jsxs)("div",{className:"border p-4 mb-4 rounded-md",children:[(0,n.jsx)("input",{type:"text",placeholder:"Section Title",value:e.title,onChange:e=>c(a,"title",e.target.value),className:"input input-bordered w-full mb-2",required:!0}),(0,n.jsx)("textarea",{placeholder:"Section Description",value:e.description,onChange:e=>c(a,"description",e.target.value),className:"input input-bordered w-full min-h-[80px]",required:!0}),(0,n.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>p(a),className:"btn btn-error btn-sm",disabled:1===t.sections.length,children:"Remove Section"}),a===t.sections.length-1&&(0,n.jsx)("button",{type:"button",onClick:u,className:"btn btn-outline btn-sm",children:"Add Section"})]})]},a))]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-semibold mb-1",children:"Categories"}),t.categories.map((e,a)=>(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("input",{type:"text",placeholder:"Category",value:e,onChange:e=>m(a,e.target.value),className:"input input-bordered flex-grow"}),(0,n.jsx)("button",{type:"button",onClick:()=>h(a),className:"btn btn-error btn-sm px-3 h-8 rounded","aria-label":"Remove category ".concat(a+1),disabled:1===t.categories.length,children:"−"}),a===t.categories.length-1&&(0,n.jsx)("button",{type:"button",onClick:g,className:"btn btn-outline btn-sm px-3 h-8 rounded","aria-label":"Add category",children:"+"})]},a))]}),(0,n.jsx)("button",{type:"submit",className:"btn btn-primary w-full py-3 text-lg font-semibold ".concat(a?"loading":""),disabled:a,children:a?"Creating...":"Create Campaign"})]})}function o(){let{data:e,status:a}=(0,t.useSession)(),i=(0,l.useRouter)(),[o,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{"unauthenticated"===a&&i.replace("/signin")},[a,i]),(0,s.useEffect)(()=>{if("authenticated"===a){if(!e||!e.user||!e.user.email){d(null),u(!1);return}let a=e.user;!async function(){u(!0);try{let e={welcomeMessage:"Welcome back, ".concat(a.name||a.email,"!"),email:a.email,role:a.role||"user"};d(e)}catch(e){console.error("Failed to load user data:",e),d(null)}u(!1)}()}},[a,e]),"loading"===a||c)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,n.jsx)("div",{className:"loader"})}):o?(0,n.jsxs)("div",{className:"min-h-screen p-8 bg-gray-50",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Dashboard"}),(0,n.jsx)("p",{className:"mb-2",children:o.welcomeMessage}),(0,n.jsxs)("p",{children:["Email: ",o.email]}),(0,n.jsxs)("p",{children:["Role: ",o.role]}),(0,n.jsx)(r,{})]}):(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsx)("p",{className:"text-red-600",children:"Failed to load your dashboard data."})})}},5695:(e,a,i)=>{"use strict";var n=i(8999);i.o(n,"useRouter")&&i.d(a,{useRouter:function(){return n.useRouter}}),i.o(n,"useSearchParams")&&i.d(a,{useSearchParams:function(){return n.useSearchParams}})}},e=>{var a=a=>e(e.s=a);e.O(0,[108,441,684,358],()=>a(108)),_N_E=e.O()}]);