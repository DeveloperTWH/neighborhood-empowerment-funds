(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[195],{201:(e,t,a)=>{Promise.resolve().then(a.bind(a,7055))},7055:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});var l=a(5155),s=a(2115),n=a(3568);function i(e){let{selected:t,onSuccess:a,clearSelected:i}=e,[o,r]=(0,s.useState)({name:"",role:"",quote:"",rating:0,photo:null}),[c,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{t&&r({name:t.name,role:t.role,quote:t.quote,rating:t.rating,photo:null})},[t]);let m=e=>{let{name:t,value:a}=e.target;r(e=>({...e,[t]:"rating"===t?parseFloat(a):a}))},u=async e=>{if(e.preventDefault(),o.rating<0||o.rating>5)return void alert("Rating must be between 0 and 5");let l=new FormData;if(l.append("name",o.name.trim()),l.append("role",o.role.trim()),l.append("quote",o.quote.trim()),l.append("rating",String(o.rating)),o.photo&&l.append("photo",o.photo),!t&&!o.photo)return void(0,n.Ay)("Please upload The Photos !");d(!0);try{if(!(await fetch(t?"/api/testimonial/".concat(t._id):"/api/testimonial",{method:t?"PUT":"POST",body:l})).ok)throw Error("Failed to submit testimonial");r({name:"",role:"",quote:"",rating:0,photo:null}),i(),a()}catch(e){console.error(e),alert("Error saving testimonial")}finally{d(!1)}};return(0,l.jsxs)("form",{onSubmit:u,className:"space-y-4 bg-white p-6 rounded shadow",children:[(0,l.jsx)("input",{name:"name",value:o.name,onChange:m,placeholder:"Name",required:!0,className:"border w-full px-3 py-2"}),(0,l.jsx)("input",{name:"role",value:o.role,onChange:m,placeholder:"Role",required:!0,className:"border w-full px-3 py-2"}),(0,l.jsx)("textarea",{name:"quote",value:o.quote,onChange:m,placeholder:"Quote",required:!0,className:"border w-full px-3 py-2"}),(0,l.jsx)("input",{type:"number",name:"rating",value:isNaN(o.rating)?"":o.rating,onChange:m,placeholder:"Rating (0-5)",min:0,max:5,step:"0.1",required:!0,className:"border w-full px-3 py-2"}),(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&r(t=>({...t,photo:e.target.files[0]}))},className:"w-full"}),(0,l.jsxs)("div",{className:"flex gap-3",children:[(0,l.jsxs)("button",{type:"submit",disabled:c,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50",children:[c?"Saving...":t?"Update":"Add"," Testimonial"]}),t&&(0,l.jsx)("button",{type:"button",onClick:i,className:"text-gray-600",children:"Cancel"})]})]})}function o(e){let{testimonials:t,onEdit:a,refresh:s,loading:n}=e,i=async e=>{if(confirm("Are you sure you want to delete this testimonial?"))try{if(!(await fetch("/api/testimonial/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete");s()}catch(e){console.error(e),alert("Error deleting testimonial")}};return(0,l.jsxs)("div",{className:"mt-10",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Existing Testimonials"}),n&&(0,l.jsx)("p",{children:"Loading..."}),!n&&0===t.length&&(0,l.jsx)("p",{children:"No testimonials found."}),(0,l.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:t.map(e=>(0,l.jsxs)("div",{className:"border rounded p-4 shadow-sm flex gap-4",children:[(0,l.jsx)("img",{src:e.photo,alt:e.name,className:"w-16 h-16 object-cover rounded-full"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"font-bold",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.role}),(0,l.jsxs)("p",{className:"italic mt-2",children:['"',e.quote,'"']}),(0,l.jsxs)("p",{className:"text-sm mt-1 text-yellow-600",children:["Rating: ",e.rating,"/5"]}),(0,l.jsxs)("div",{className:"mt-3 flex gap-3",children:[(0,l.jsx)("button",{className:"text-blue-600 underline",onClick:()=>a(e),children:"Edit"}),(0,l.jsx)("button",{className:"text-red-600 underline",onClick:()=>i(e._id),children:"Delete"})]})]})]},e._id))})]})}function r(){let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(null),[r,c]=(0,s.useState)(!1),d=(0,s.useRef)(null),m=async()=>{let e=await fetch("/api/testimonial");t(await e.json())};(0,s.useEffect)(()=>{m()},[]);let u=async()=>{try{c(!0);let e=await fetch("/api/testimonial"),a=await e.json();t(a)}catch(e){console.error("Failed to load testimonials:",e)}finally{c(!1)}};(0,s.useEffect)(()=>{u()},[]);let p=()=>{var e;null==(e=d.current)||e.scrollIntoView({behavior:"smooth"})};return(0,l.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-10",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Manage Testimonials"}),(0,l.jsx)("div",{ref:d,children:(0,l.jsx)(i,{selected:a,onSuccess:u,clearSelected:()=>n(null)})}),(0,l.jsx)("hr",{className:"my-6"}),(0,l.jsx)(o,{testimonials:e,onEdit:e=>{n(e),p()},refresh:u,loading:r})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[3568,8441,1684,7358],()=>t(201)),_N_E=e.O()}]);