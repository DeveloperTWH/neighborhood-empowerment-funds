(()=>{var e={};e.id=6100,e.ids=[6100],e.modules={3040:(e,t,r)=>{"use strict";r.d(t,{q:()=>i});var s=r(56037),a=r.n(s);let n=process.env.MONGODB_URI;async function i(){a().connections[0].readyState||await a().connect(n)}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5286:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(55511),a=r.n(s);let n=new Uint8Array(256),i=n.length;function o(){return i>n.length-16&&(a().randomFillSync(n),i=0),n.slice(i,i+=16)}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32170:(e,t,r)=>{"use strict";r.d(t,{K:()=>i});var s=r(56037),a=r.n(s);let n=new(a()).Schema({name:{type:String,required:!0},email:{type:String,unique:!0,required:!0},hashedPassword:{type:String,default:null},oauthProvider:{type:String,default:null},oauthId:{type:String,default:null},role:{type:String,enum:["user","admin"],default:"user"},avatar:{type:String,default:null}},{timestamps:!0}),i=a().models.User||a().model("User",n)},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},56037:e=>{"use strict";e.exports=require("mongoose")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64352:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>A,routeModule:()=>h,serverHooks:()=>q,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>j});var s={};r.r(s),r.d(s,{DELETE:()=>y,GET:()=>g,PUT:()=>w});var a=r(96559),n=r(48088),i=r(37719),o=r(32190),u=r(3040),d=r(32170),l=r(79748),p=r.n(l),c=r(33873),f=r.n(c),m=r(84113);function v(e){let t=new URL(e.url).pathname.match(/\/api\/users\/([^\/]+)/);return t?t[1]:null}async function g(e){await (0,u.q)();let t=v(e);if(!t)return o.NextResponse.json({error:"Missing user ID"},{status:400});let r=await d.K.findById(t);return r?o.NextResponse.json(r):o.NextResponse.json({error:"User not found"},{status:404})}async function w(e){await (0,u.q)();let t=v(e);if(!t)return o.NextResponse.json({error:"Missing user ID"},{status:400});let r=await e.formData(),s=r.get("name"),a=r.get("email"),n=r.get("phone"),i="true"===r.get("removeAvatar"),l=r.get("avatar"),c=await d.K.findById(t);if(!c)return o.NextResponse.json({error:"User not found"},{status:404});let g=c.avatar;if(i&&g?.startsWith("/uploads/avatars")){try{await p().unlink(f().join(process.cwd(),"public",g))}catch{console.warn("Old avatar already deleted or missing.")}g=""}if(l&&l.size>0){let e=Buffer.from(await l.arrayBuffer()),t=`${(0,m.A)()}_${l.name}`,r=f().join(process.cwd(),"public/uploads/avatars"),s=f().join(r,t),a=`/uploads/avatars/${t}`;if(await p().mkdir(r,{recursive:!0}),await p().writeFile(s,e),g?.startsWith("/uploads/avatars"))try{await p().unlink(f().join(process.cwd(),"public",g))}catch{console.warn("Old avatar already deleted or missing.")}g=a}return c.name=s,c.email=a,c.phone=n,c.avatar=g,await c.save(),o.NextResponse.json(c)}async function y(e){await (0,u.q)();let t=v(e);if(!t)return o.NextResponse.json({error:"Missing user ID"},{status:400});let r=await d.K.findById(t);if(!r)return o.NextResponse.json({error:"User not found"},{status:404});if(r.avatar?.startsWith("/uploads/avatars"))try{await p().unlink(f().join(process.cwd(),"public",r.avatar))}catch{console.warn("Avatar already deleted or missing.")}return await d.K.findByIdAndDelete(t),o.NextResponse.json({success:!0,message:"User deleted successfully"})}let h=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/users/[id]/route",pathname:"/api/users/[id]",filename:"route",bundlePath:"app/api/users/[id]/route"},resolvedPagePath:"C:\\Users\\DAY\\OneDrive\\Desktop\\Neighborhood\\neighborhood-empowerment-funds\\app\\api\\users\\[id]\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:j,serverHooks:q}=h;function A(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:j})}},73726:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&s.test(e)}},78335:()=>{},79748:e=>{"use strict";e.exports=require("fs/promises")},84113:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(5286),a=r(89386);let n=function(e,t,r){let n=(e=e||{}).random||(e.rng||s.A)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return(0,a.A)(n)}},89386:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(73726);let a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).substr(1));let n=function(e,t=0){let r=(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase();if(!(0,s.A)(r))throw TypeError("Stringified UUID is invalid");return r}},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7719,580],()=>r(64352));module.exports=s})();